function URLParser(){this.plugins={}}URLParser.prototype.parse=function(a){var b=a.match(/(?:https?:\/\/)?(?:[^\.]+\.)?(\w+)\./i),c=b?b[1]:void 0;if(b&&c&&this.plugins[c]&&(a=this.plugins[c].parse.call(this,a)))return a.provider=this.plugins[c].provider,a};URLParser.prototype.bind=function(a){this.plugins[a.provider]=a;if(a.alternatives){var b;for(b=0;b<a.alternatives.length;b+=1)this.plugins[a.alternatives[b]]=a}};
URLParser.prototype.create=function(a){if(this.plugins[a.provider].create)return this.plugins[a.provider].create.call(this,a)};var urlParser=new URLParser;function getTime(a){var b=0,c=0,d,e={s:1,m:60,h:3600,d:86400,w:604800};if(!a.match(/^(\d+[smhdw]?)+$/))return 0;for(d=0;d<a.length;d+=1)"0"<=a[d]&&"9">=a[d]?c=10*c+parseInt(a[d],10):(a[d]in e&&(b+=e[a[d]]*c,delete e[a[d]]),c=0);0!==c&&"s"in e&&(b+=c,delete e.s);return b}
"function"!==typeof String.prototype.format&&(String.prototype.format=function(){var a=this,b,c;for(b=0;b<arguments.length;b+=1)c=new RegExp("\\{"+b+"\\}","gm"),a=a.replace(c,arguments[b]);return a});
urlParser.bind({provider:"dailymotion",alternatives:["dai"],parse:function(a){var b,c,d={};c=(b=a.match(/(?:\/video|ly)\/([A-Za-z0-9]+)/i))?b[1]:void 0;a=(b=a.match(/[#\?&]start=([A-Za-z0-9]+)/i))?getTime(b[1]):void 0;if(c)return d.mediaType="video",d.id=c,a&&(d.startTime=a),d},create:function(a){return a.startTime?"http://www.dailymotion.com/video/{0}?start={1}".format(a.id,a.startTime):"http://dai.ly/{0}".format(a.id)}});
urlParser.bind({provider:"livestream",parse:function(a){return(a=(a=a.match(/livestream\.com\/(\w+)/i))?a[1]:void 0)?{mediaType:"stream",channel:a}:void 0}});
urlParser.bind({provider:"twitch",parse:function(a){var b,c,d,e,f={};d=(b=a.match(/twitch\.tv\/(\w+)(?:\/(.)\/(\d+))?/i))?b[1]:void 0;e=b?b[2]:void 0;c=b?b[3]:void 0;if(d=(b=a.match(/(?:\?channel|\&utm_content)=(\w+)/i))?b[1]:d)return c?(f.mediaType="video",f.id=c,f.videoIdPrefix=e):f.mediaType="stream",f.channel=d,f},create:function(a){var b;"stream"===a.mediaType?b="http://twitch.tv/{0}".format(a.channel):"video"===a.mediaType&&(b="http://twitch.tv/{0}/{1}/{2}".format(a.channel,a.videoIdPrefix,
a.id));return b}});urlParser.bind({provider:"vimeo",alternatives:["vimeopro"],parse:function(a){return(a=(a=a.match(/(?:\/(?:channels\/[\w]+|(?:album\/\d+\/)?videos?))?\/(\d+)/i))?a[1]:void 0)?{mediaType:"video",id:a}:void 0},create:function(a){return"http://vimeo.com/{0}".format(a.id)}});
urlParser.bind({provider:"youtube",alternatives:["youtu"],parse:function(a){var b,c,d,e={};c=(b=a.match(/(?:(?:v|be|videos)\/|v=)([\w\-]{11})/i))?b[1]:void 0;d=(b=a.match(/list=([\w\-]+)/i))?b[1]:void 0;a=(b=a.match(/[#\?&](?:star)?t=([A-Za-z0-9]+)/i))?getTime(b[1]):void 0;if(c)e.mediaType="video",e.id=c,d&&(e.playlistId=d),a&&(e.startTime=a);else if(d)e.mediaType="playlist",e.playlistId=d;else return;return e},create:function(a){var b;"video"===a.mediaType?(b=a.playlistId?"https://www.youtube.com/watch?v={0}&list={1}".format(a.id,
a.playlistId):"http://youtu.be/{0}".format(a.id),a.startTime&&(b+="#t={0}".format(a.startTime))):"playlist"===a.mediaType&&(b="https://www.youtube.com/playlist?feature=share&list={0}".format(a.playlistId));return b}});
